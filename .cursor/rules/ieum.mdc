# Swift iOS Project Cursor Rules

## Tech Stack
- UIKit (Code-based, No Storyboard)
- Architecture: MVVM + Combine
- UI: SnapKit, Then
- Networking: Alamofire with Interceptors
- SwiftUI integration via UIHostingController when needed

## Project Structure
```
├── App/
├── Presentation/
│   ├── Scenes/
│   │   └── [Feature]/
│   │       ├── [Feature]ViewController.swift
│   │       ├── [Feature]ViewModel.swift
│   │       └── [Feature]View.swift (SwiftUI)
│   ├── Common/
│   │   ├── Base/
│   │   └── Components/
│   └── Theme/
│       ├── Colors.swift
│       ├── Fonts.swift
│       └── Theme.swift
├── Domain/
│   ├── Entities/
│   └── UseCases/
├── Data/
│   ├── Network/
│   │   ├── API/
│   │   ├── Interceptors/
│   │   └── Endpoints/
│   └── DTOs/
└── Core/
    ├── Extensions/
    └── Utils/
```

## Theme System

### Colors
```swift
enum Colors {
    static let primary = UIColor.systemBlue
    static let secondary = UIColor.systemGray
    static let background = UIColor.systemBackground
    static let text = UIColor.label
    static let error = UIColor.systemRed
}
```

### Fonts
```swift
enum Fonts {
    static let largeTitle = UIFont.systemFont(ofSize: 34, weight: .bold)
    static let title = UIFont.systemFont(ofSize: 24, weight: .semibold)
    static let body = UIFont.systemFont(ofSize: 16, weight: .regular)
    static let caption = UIFont.systemFont(ofSize: 12, weight: .regular)
}
```

## ViewController Template
```swift
final class ExampleViewController: UIViewController {
    private let viewModel: ExampleViewModel
    private var cancellables = Set<AnyCancellable>()
    
    private let titleLabel = UILabel().then {
        $0.textColor = Colors.text
        $0.font = Fonts.title
    }
    
    init(viewModel: ExampleViewModel) {
        self.viewModel = viewModel
        super.init(nibName: nil, bundle: nil)
    }
    
    required init?(coder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupUI()
        bindViewModel()
    }
    
    private func setupUI() {
        view.backgroundColor = Colors.background
        view.addSubview(titleLabel)
        
        titleLabel.snp.makeConstraints { make in
            make.center.equalToSuperview()
        }
    }
    
    private func bindViewModel() {
        viewModel.$title
            .receive(on: DispatchQueue.main)
            .sink { [weak self] title in
                self?.titleLabel.text = title
            }
            .store(in: &cancellables)
    }
}
```

## ViewModel Template
```swift
final class ExampleViewModel: ObservableObject {
    // Inputs
    let viewDidLoad = PassthroughSubject<Void, Never>()
    
    // Outputs
    @Published private(set) var title = ""
    @Published private(set) var isLoading = false
    
    private let useCase: ExampleUseCase
    private var cancellables = Set<AnyCancellable>()
    
    init(useCase: ExampleUseCase) {
        self.useCase = useCase
        bindInputs()
    }
    
    private func bindInputs() {
        viewDidLoad
            .sink { [weak self] in self?.loadData() }
            .store(in: &cancellables)
    }
}
```

## SwiftUI Integration
```swift
struct ExampleView: View {
    @ObservedObject var viewModel: ExampleViewModel
    
    var body: some View {
        Text(viewModel.title)
            .onAppear { viewModel.viewDidLoad.send() }
    }
}

// In ViewController
let hostingController = UIHostingController(rootView: ExampleView(viewModel: viewModel))
```

## Networking
```swift
// API Service
final class APIService {
    private let session: Session
    
    init() {
        session = Session(interceptor: AuthInterceptor())
    }
    
    func request<T: Decodable>(_ endpoint: Endpoint) -> AnyPublisher<T, Error> {
        session.request(endpoint.url, method: endpoint.method)
            .validate()
            .publishDecodable(type: T.self)
            .value()
            .eraseToAnyPublisher()
    }
}

// Interceptor
final class AuthInterceptor: RequestInterceptor {
    func adapt(_ urlRequest: URLRequest, for session: Session, completion: @escaping (Result<URLRequest, Error>) -> Void) {
        var request = urlRequest
        request.setValue("Bearer \(token)", forHTTPHeaderField: "Authorization")
        completion(.success(request))
    }
}
```

## Code Conventions
- Use `weak self` in closures
- No force unwrapping
- Use Theme colors/fonts consistently
- Store Combine subscriptions in `cancellables`
- Use `receive(on: DispatchQueue.main)` for UI updates
- ViewControllers suffix: `ViewController`
- ViewModels suffix: `ViewModel`
- Keep ViewControllers lightweight (logic in ViewModel)
- Use dependency injection